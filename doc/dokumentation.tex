\input{template.tex}

% Dokumentinformationen
\newcommand{\SUBJECT}{Dokumentation}
\newcommand{\TITLE}{Sunlight Alarm}
\newcommand{\SECONDAUTHOR}{Fabian Hauser}

\input{front.tex}

\section{Vorbereitung}

\subsection{Hardware}
Was du für deinen persönlichen Sunlight Alarm benötigst:
\begin{itemize}
	\item Raspberry Pi Zero mit 
	\begin{itemize}
		\item Raspbery Pi WiFi dongle
		\item micro-B USB Ladekabel
		\item microSD Card
		\item Dupont cable (auf beiden Seiten female) für die Verbindung zwischen Wireless Sender und Raspberry Pi Zero
	\end{itemize}
	\item nRF24L01+ 2.4Ghz Wireless Sender \footnote{http://www.dx.com/de/p/nrf24l01-2-4ghz-wireless-transceiver-module-black-149483}
	\item Mi-Light GU10 Wireless Lamp
\end{itemize}

\subsection{Funktchip Verbinden}
Der Funktchip wird nun mit den Dupont Kabel mit dem Raspberry Pi Zero verbunden. Dazu ist der Pin-Belegungs-Plan unter http://pinout.xyz/ sehr nützlich.
\begin{table}[h]
\centering
\begin{tabu} to \linewidth {l c c}
	\toprule
	Leitung & Pim beim nRF24L01+ & Pin beim Zero \\
	GND (Ground / Erdung) & 1 & 20 \\
	3.3 Volt & 2 & 17 \\
	CE (chip enable bzw. slave select) & 3 & 22 \\
	CSN (chip select not) & 4 & 24 \\
	SCLK (serial clock) & 5 & 23 \\
	MOSI (Master Output Slave Input) & 6 & 19 \\
	MISO (Master Input Slave Output) & 7 & 21 \\
	\bottomrule
	\end{tabu}
	\caption{Dupont Verbindungen zwischen Rasperberry Pi Zero und nRF24L01+}
\end{table}

\subsection{Raspberry aufsetzen}
\begin{enumerate}
	\item SD Karte mit dem Notebook verbinden
	\item 
	\item sudo apt-get update
	\item sudo apt-get dist-upgrade
\end{enumerate}

\subsection{Wireless konfigurieren}
\begin{enumerate}
\item SD Karte an Laptop anschliessen
\item mount 
\item cd run/media/.../...
\item sudo vim /etc/wpa\_supplicant/wpa\_supplicant.conf
\begin{lstlisting}[caption=/etc/wpa\_supplicant/wpa\_supplicant.conf]
network={
 ssid="ssid"
 psk="pw"
 proto=RSN
 key_mgmt=WPA-PSK
 scan_ssid=1
}
\end{lstlisting}
\item umount /run/media/.../...
\end{enumerate}

\subsubsection{Verbinden}
\begin{enumerate}
	\item ssh pi@192.168.x.y
	\item Passwort eingeben
\end{enumerate}

\section{Software}
\begin{enumerate}
	\item git clone https://github.com/TMRh20/RF24
	\item cd RF24
	\item make
	\item sudo make install
\end{enumerate}

\subsection{}
%TODO update repo
\begin{enumerate}
	\item cd /opt
	\item git clone https://github.com/fabianhauser/milight-muell
	\item cd ...
	\item make
\end{enumerate}

\section{Befehle}
\begin{table}[h]
	\centering
	\begin{tabu} to \linewidth {l c}
		\toprule
		Hexwert & Taste \\
		0x & a \\
		\bottomrule
	\end{tabu}
	\caption{Openmilight Hex Befehlstabelle}
\end{table}




\input{appendix}